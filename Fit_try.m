clear();
mu1 = [0 0];
sigma1 = [25 3; 3 10];
mu2=[45,45];
sigma2=[25 3; 3 5];
mu3=[-25,-25];
sigma3=[10 3; 3 10];
x1 = -100:0.01:100;
x2 = -100:0.011:100;
[X1,X2] = meshgrid(x1,x2);
X = [X1(:) X2(:)];
y1 = mvnpdf(X,mu1,sigma1);
y2 = mvnpdf(X,mu2,sigma2);
y3 = mvnpdf(X,mu3,sigma3);
y=y1+y2+y3;
y=reshape(y,length(x1),length(x2));
surf(x1,x2,y);
peaks=imregionalmax(y);
[i,j]=find(peaks);
a1=i(1);
b1=j(1);
a2=i(2);
b2=j(2);
c=sqrt((a1-a2)^2+(b1-b2)^2);
round(c);

